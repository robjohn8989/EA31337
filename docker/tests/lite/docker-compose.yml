version: '3'
services:

  compile_lite:
    command: make -C /opt/EA Lite
    volumes:
    - ../../..:/opt/EA:rw
    image: ea31337/ea-tester:dev
  compile_lite_backtest:
    command: make -C /opt/EA Lite-Backtest
    volumes:
    - ../../..:/opt/EA:rw
    image: ea31337/ea-tester:dev
  compile_lite_release:
    command: make -C /opt/EA Lite-Release
    volumes:
    - ../../..:/opt/EA:rw
    image: ea31337/ea-tester:dev

  test_2018_01:
    command: run_backtest -v
    volumes:
    - ../../..:/opt/src:rw
    - ./_results:/opt/_results:rw
#   - ../../../../EA-Tester/scripts:/opt/scripts
    image: ea31337/ea-tester:EURUSD-2018-DS
    env_file: .env
    environment:
      BT_MONTHS: 01
      TEST_REPORT_NAME: EA31337_Lite_201801
  test_2018_02:
    command: run_backtest -v
    volumes:
    - ../../..:/opt/src:rw
    - ./_results:/opt/_results:rw
    image: ea31337/ea-tester:EURUSD-2018-DS
    env_file: .env
    environment:
      BT_MONTHS: 02
      TEST_REPORT_NAME: EA31337_Lite_201802
  test_2018_03:
    command: run_backtest -v
    volumes:
    - ../../..:/opt/src:rw
    - ./_results:/opt/_results:rw
    image: ea31337/ea-tester:EURUSD-2018-DS
    env_file: .env
    environment:
      BT_MONTHS: 03
      TEST_REPORT_NAME: EA31337_Lite_201803
  test_2018_04:
    command: run_backtest -v
    volumes:
    - ../../..:/opt/src:rw
    - ./_results:/opt/_results:rw
    image: ea31337/ea-tester:EURUSD-2018-DS
    env_file: .env
    environment:
      BT_MONTHS: 04
      TEST_REPORT_NAME: EA31337_Lite_201804
  test_2018_05:
    command: run_backtest -v
    volumes:
    - ../../..:/opt/src:rw
    - ./_results:/opt/_results:rw
    image: ea31337/ea-tester:EURUSD-2018-DS
    env_file: .env
    environment:
      BT_MONTHS: 05
      TEST_REPORT_NAME: EA31337_Lite_201805
  test_2018_06:
    command: run_backtest -v
    volumes:
    - ../../..:/opt/src:rw
    - ./_results:/opt/_results:rw
    image: ea31337/ea-tester:EURUSD-2018-DS
    env_file: .env
    environment:
      BT_MONTHS: 06
      TEST_REPORT_NAME: EA31337_Lite_201806
  test_2018_07:
    command: run_backtest -v
    volumes:
    - ../../..:/opt/src:rw
    - ./_results:/opt/_results:rw
    image: ea31337/ea-tester:EURUSD-2018-DS
    env_file: .env
    environment:
      BT_MONTHS: 07
      TEST_REPORT_NAME: EA31337_Lite_201807
  test_2018_08:
    command: run_backtest -v
    volumes:
    - ../../..:/opt/src:rw
    - ./_results:/opt/_results:rw
    image: ea31337/ea-tester:EURUSD-2018-DS
    env_file: .env
    environment:
      BT_MONTHS: 08
      TEST_REPORT_NAME: EA31337_Lite_201808
  test_2018_09:
    command: run_backtest -v
    volumes:
    - ../../..:/opt/src:rw
    - ./_results:/opt/_results:rw
    image: ea31337/ea-tester:EURUSD-2018-DS
    env_file: .env
    environment:
      BT_MONTHS: 09
      TEST_REPORT_NAME: EA31337_Lite_201809
  test_2018_10:
    command: run_backtest -v
    volumes:
    - ../../..:/opt/src:rw
    - ./_results:/opt/_results:rw
    image: ea31337/ea-tester:EURUSD-2018-DS
    env_file: .env
    environment:
      BT_MONTHS: 10
      TEST_REPORT_NAME: EA31337_Lite_201810
  test_2018_11:
    command: run_backtest -v
    volumes:
    - ../../..:/opt/src:rw
    - ./_results:/opt/_results:rw
    image: ea31337/ea-tester:EURUSD-2018-DS
    env_file: .env
    environment:
      BT_MONTHS: 11
      TEST_REPORT_NAME: EA31337_Lite_201811
  test_2018_12:
    command: run_backtest -v
    volumes:
    - ../../..:/opt/src:rw
    - ./_results:/opt/_results:rw
    image: ea31337/ea-tester:EURUSD-2018-DS
    env_file: .env
    environment:
      BT_MONTHS: 12
      TEST_REPORT_NAME: EA31337_Lite_201812
